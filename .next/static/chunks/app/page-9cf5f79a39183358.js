(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2491:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>Q});var s=t(5155),n=t(2115),i=t(9408),r=t(6485),o=t(1873),l=t(1169),c=t(5710),d=t(4788),m=t(7586),u=t(7801),p=t(6989),h=t(8519),g=t(1456),x=t(5299),f=t(5880),y=t(1362),b=t(9708);let v=[{id:"metadata",label:"Business Metadata",icon:i.A},{id:"services",label:"Services",icon:r.A},{id:"locations",label:"Locations",icon:o.A},{id:"resources",label:"Resources",icon:l.A},{id:"data",label:"User Data Fields",icon:c.A},{id:"integrations",label:"System Integrations",icon:d.A},{id:"conversation",label:"Behavior Rules",icon:m.A},{id:"safety",label:"Safety & Boundaries",icon:u.A},{id:"mode",label:"Operation Modes",icon:p.A},{id:"vapi",label:"VAPI Setup",icon:p.A},{id:"billing",label:"Plan & Billing",icon:h.A}],N=e=>{let{activeSection:a,onNavigate:t,onLock:n,onLaunchClient:i,isValid:r,isSaving:o,isLocked:l,isLaunching:c,agents:d,onSelectAgent:m,branding:u,currentAgentId:h}=e;return(0,s.jsxs)("aside",{className:"w-64 bg-slate-900 text-slate-300 flex flex-col h-screen fixed left-0 top-0 overflow-y-auto border-r border-slate-800",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-slate-800",children:[(0,s.jsxs)("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(null==u?void 0:u.logoUrl)?(0,s.jsx)("img",{src:u.logoUrl,alt:"Logo",className:"w-8 h-8 object-contain"}):(0,s.jsx)("div",{className:"w-8 h-8 bg-brand-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(p.A,{className:"w-5 h-5 text-white"})}),(null==u?void 0:u.appName)||"Voice Admin"]}),(0,s.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Configurator v1.0"})]}),d.length>0&&(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-slate-800 bg-slate-900/50",children:[(0,s.jsx)("label",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 mb-2 block",children:"Organization Agents"}),(0,s.jsx)("div",{className:"space-y-1",children:d.map(e=>{var a;return(0,s.jsxs)("button",{onClick:()=>m(e.id),className:"w-full text-left px-2 py-1.5 rounded text-xs transition-colors flex items-center gap-2 ".concat(e.id===h?"bg-slate-800 text-white font-medium border border-slate-700":"text-slate-400 hover:text-slate-200 hover:bg-slate-800/50"),children:[(0,s.jsx)(g.A,{className:"w-3 h-3 text-brand-500"}),(0,s.jsx)("span",{className:"truncate",children:(null==(a=e.metadata)?void 0:a.businessName)||e.id})]},e.id)})})]}),(0,s.jsx)("nav",{className:"flex-1 py-4",children:(0,s.jsx)("ul",{className:"space-y-1",children:v.map(e=>{let n=e.icon,i=a===e.id;return(0,s.jsx)("li",{children:(0,s.jsxs)("button",{onClick:()=>t(e.id),className:"w-full flex items-center gap-3 px-6 py-3 text-sm font-medium transition-colors ".concat(i?"bg-brand-900/30 text-brand-500 border-r-2 border-brand-500":"hover:bg-slate-800 hover:text-white"),children:[(0,s.jsx)(n,{className:"w-4 h-4 ".concat(i?"text-brand-500":"text-slate-500")}),e.label]})},e.id)})})}),(0,s.jsxs)("div",{className:"p-6 border-t border-slate-800 space-y-3",children:[(0,s.jsxs)("button",{onClick:i,disabled:c,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold bg-slate-800 text-indigo-400 hover:bg-slate-700 hover:text-indigo-300 border border-slate-700 transition-all disabled:opacity-70 disabled:cursor-wait",title:"Open Live Agent Interface",children:[c?(0,s.jsx)(x.A,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(f.A,{className:"w-4 h-4"}),c?"Launching...":"Launch Web Client"]}),(0,s.jsxs)("button",{onClick:n,disabled:!r||o||l,className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-sm font-bold transition-all ".concat(r&&!l?"bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-900/20":"bg-slate-800 text-slate-500 cursor-not-allowed"," ").concat(o?"opacity-80 cursor-wait":""),children:[o?(0,s.jsx)(x.A,{className:"w-4 h-4 animate-spin"}):r&&!l?(0,s.jsx)(y.A,{className:"w-4 h-4"}):(0,s.jsx)(b.A,{className:"w-4 h-4"}),o?"Saving...":r&&!l?"Validate & Lock":l?"Locked":"Incomplete"]})]})]})};var w=t(2056),A=t(908),j=t(5426),I=t(2987),C=t(532),S=t(6907);let E=e=>{let{onLogin:a,onDemoLogin:t,isLoggingIn:i}=e,[o,l]=(0,n.useState)(null),c=async()=>{l(null);try{await a()}catch(e){l(e.message||"Failed to sign in")}},d=o&&(o.includes("CONFIGURATION_ERROR")||o.includes("api-key-not-valid")),m=o&&(o.includes("DOMAIN_NOT_ALLOWED")||o.includes("unauthorized-domain")),u=o&&(o.includes("AUTH_ERROR")||o.includes("operation-not-allowed")),h=o&&o.includes("Login cancelled"),g=o&&(o.includes("API_KEY_ERROR")||o.includes("api-key-not-valid")),y="https://".concat("ai-voice-agent-c2a2b.firebaseapp.com","/__/auth/handler");return(0,s.jsxs)("div",{className:"min-h-screen bg-slate-900 flex flex-col items-center justify-center p-4 relative overflow-hidden",children:[(0,s.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden z-0 opacity-20 pointer-events-none",children:[(0,s.jsx)("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-brand-600 rounded-full blur-[128px]"}),(0,s.jsx)("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-600 rounded-full blur-[128px]"})]}),(0,s.jsxs)("div",{className:"w-full ".concat(d||m||u||h||g?"max-w-2xl":"max-w-md"," bg-slate-800/80 backdrop-blur-xl border border-slate-700 rounded-2xl shadow-2xl p-8 z-10 transition-all duration-300"),children:[(0,s.jsx)("div",{className:"flex justify-center mb-8",children:(0,s.jsx)("div",{className:"w-16 h-16 bg-brand-600 rounded-xl flex items-center justify-center shadow-lg shadow-brand-900/50",children:(0,s.jsx)(p.A,{className:"w-8 h-8 text-white"})})}),(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Voice AI Admin"}),(0,s.jsx)("p",{className:"text-slate-400",children:"Sign in to configure your AI Agents"})]}),o&&(0,s.jsxs)("div",{className:"mb-6 rounded-lg overflow-hidden border border-red-800 bg-red-900/20",children:[(0,s.jsxs)("div",{className:"p-4 flex items-start gap-3 bg-red-900/30",children:[(0,s.jsx)(w.A,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,s.jsx)("p",{className:"text-sm text-red-200 font-medium break-words",children:d?"Configuration Required":m?"Domain Not Authorized":u?"Provider Not Enabled":g?"API Key Rejected":h?"Login Cancelled / Blocked":o})]}),h&&(0,s.jsxs)("div",{className:"p-4 bg-slate-950/50 text-left border-t border-red-800/50 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-sm text-white font-semibold flex items-center gap-2",children:[(0,s.jsx)(A.A,{className:"w-4 h-4 text-brand-400"}),'Fixing "redirect_uri_mismatch"']}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:'If you saw "Error updating Google" in Firebase Console, follow these steps instead of trying to fix Firebase.'})]}),(0,s.jsxs)("ol",{className:"text-xs text-slate-300 space-y-3 list-decimal pl-4",children:[(0,s.jsxs)("li",{children:["Go to ",(0,s.jsx)("a",{href:"https://console.cloud.google.com/apis/credentials?project=ai-voice-agent-c2a2b",target:"_blank",className:"text-brand-400 hover:underline",children:"Google Cloud Console > Credentials"}),"."]}),(0,s.jsxs)("li",{children:["Find the client named ",(0,s.jsx)("strong",{children:'"Web client (auto created by Google Service)"'}),".",(0,s.jsx)("div",{className:"text-slate-500 italic mt-0.5",children:"Do NOT use the one you created manually."})]}),(0,s.jsxs)("li",{children:['Edit it and add this EXACT URI to "Authorized redirect URIs":',(0,s.jsxs)("div",{className:"mt-2 flex items-center gap-2 bg-slate-900 p-2 rounded border border-slate-700",children:[(0,s.jsx)("code",{className:"text-emerald-400 font-mono break-all",children:y}),(0,s.jsx)("button",{onClick:()=>navigator.clipboard.writeText(y),className:"text-slate-500 hover:text-white p-1",children:(0,s.jsx)(j.A,{className:"w-4 h-4"})})]})]}),(0,s.jsx)("li",{children:"Click Save and try logging in again."})]})]}),g&&(0,s.jsxs)("div",{className:"p-4 bg-slate-950/50 text-left border-t border-red-800/50 space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-slate-300",children:"Your API Key is being rejected. This usually means one of the following:"}),(0,s.jsxs)("div",{className:"text-xs text-slate-400 space-y-3",children:[(0,s.jsxs)("div",{className:"p-3 bg-blue-900/10 border border-blue-800/30 rounded",children:[(0,s.jsx)("p",{className:"text-blue-300 font-bold mb-1 uppercase tracking-tighter",children:"1. Project Mismatch (Most Common)"}),(0,s.jsxs)("p",{children:["Your ",(0,s.jsx)("code",{children:".env"})," project ID is ",(0,s.jsx)("strong",{children:"ai-voice-agent-c2a2b"}),", but you might be using an API key from a different project (like 'tyjblogs'). Ensure you are viewing the correct project in Google Cloud Console."]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-200 font-semibold",children:"2. Identity Toolkit API is Disabled"}),(0,s.jsxs)("p",{children:["Go to ",(0,s.jsx)("a",{href:"https://console.cloud.google.com/apis/library/identitytoolkit.googleapis.com?project=ai-voice-agent-c2a2b",target:"_blank",className:"text-brand-400 hover:underline",children:"Google Cloud Console"})," and click ",(0,s.jsx)("strong",{children:'"Enable"'})," for the Identity Toolkit API."]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-slate-200 font-semibold",children:"3. Authorized Domains"}),(0,s.jsxs)("p",{children:["Ensure ",(0,s.jsx)("code",{children:"admin-voice-agent-lac.vercel.app"})," is added to ",(0,s.jsx)("strong",{children:"Authorized Domains"})," in your Firebase Console > Authentication > Settings."]})]})]})]}),u&&(0,s.jsxs)("div",{className:"p-4 bg-slate-950/50 text-left border-t border-red-800/50",children:[(0,s.jsx)("p",{className:"text-sm text-slate-300 mb-3",children:"Google Sign-In is currently disabled in your Firebase project settings."}),(0,s.jsxs)("div",{className:"text-xs text-slate-400 space-y-2 mb-4",children:[(0,s.jsxs)("p",{children:["1. Go to ",(0,s.jsxs)("a",{href:"https://console.firebase.google.com/",target:"_blank",rel:"noreferrer",className:"text-brand-400 hover:underline inline-flex items-center gap-1",children:["Firebase Console ",(0,s.jsx)(f.A,{className:"w-3 h-3"})]})]}),(0,s.jsxs)("p",{children:["2. Select your project: ",(0,s.jsx)("strong",{children:"ai-voice-agent-c2a2b"})]}),(0,s.jsxs)("p",{children:["3. Navigate to ",(0,s.jsx)("strong",{children:"Authentication"})," > ",(0,s.jsx)("strong",{children:"Sign-in method"})]}),(0,s.jsxs)("p",{children:["4. Click ",(0,s.jsx)("strong",{children:"Add new provider"})," (or edit Google if listed)"]}),(0,s.jsxs)("p",{children:["5. Select ",(0,s.jsx)("strong",{children:"Google"}),", toggle ",(0,s.jsx)("strong",{children:"Enable"}),", and click ",(0,s.jsx)("strong",{children:"Save"})]})]})]})]}),(0,s.jsx)("div",{className:"space-y-4 mb-8",children:(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-slate-700/50 rounded-lg border border-slate-600",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg text-blue-400",children:(0,s.jsx)(r.A,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-slate-200",children:"Calendar Integration"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Access to manage bookings"})]})]})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("button",{onClick:c,disabled:i,className:"w-full bg-white text-slate-900 font-bold py-3 px-4 rounded-xl hover:bg-slate-100 transition-all flex items-center justify-center gap-2 group disabled:opacity-70 disabled:cursor-not-allowed",children:[i?(0,s.jsx)(x.A,{className:"w-5 h-5 animate-spin"}):(0,s.jsx)("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",className:"w-5 h-5",alt:"Google"}),(0,s.jsx)("span",{children:i?"Connecting...":"Sign in with Google"}),!i&&(0,s.jsx)(I.A,{className:"w-4 h-4 text-slate-400 group-hover:translate-x-1 transition-transform"})]}),t&&(0,s.jsxs)("button",{onClick:t,className:"w-full bg-slate-800 text-slate-400 font-semibold py-3 px-4 rounded-xl hover:bg-slate-700 hover:text-white transition-all flex items-center justify-center gap-2",children:[(0,s.jsx)(C.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:h?"Skip Login (Demo Mode)":"Continue in Demo Mode"})]})]}),(0,s.jsxs)("p",{className:"text-center text-xs text-slate-500 mt-6",children:[(0,s.jsx)(S.A,{className:"w-3 h-3 inline mr-1"}),"Secure Enterprise Access"]})]})]})};var P=t(6902);async function _(e,a,t){let s="AIzaSyDSxn-D1F6GoTO0oKi3Kyo6_DLRRF0I5_8".trim().replace(/^["']|["']$/g,"");if(s?console.log("[Gemini Service] Initializing with key starting with: ".concat(s.substring(0,4),"... (Length: ").concat(s.length,")")):console.warn("[Gemini Service] No API Key found in environment variables."),!s||"undefined"===s||"null"===s)throw Error("System configuration error: API Key is missing or undefined.");let n=new P.ij(s),i='\n    You are an expert Voice AI Configuration Admin.\n    Your job is to generate a structured JSON configuration for a Voice AI agent based on a short business description provided by the user.\n    \n    If "REAL WORLD RESEARCH DATA" is provided, prioritize that information. If the research data is missing specific fields (like specific staff names or detailed hours), use your knowledge to invent plausible ones that fit the context.\n    \n    Populate the following sections:\n    - Business Metadata\n        - Services (Invent plausible services with durations)\n    - Locations (Invent a plausible location)\n        - Resources (Invent staff or rooms if applicable)\n    - Data Fields (Recommend mandatory fields)\n    - Conversation Rules (Match the tone to the business type)\n        - Safety Boundaries (Relevant to the industry)\n        - VAPI Configuration (Crucial: Generate a specialized System Prompt and Knowledge Base)\n    \n    '.concat(t?'\n    INDUSTRY TEMPLATE CONTEXT:\n    The user has selected the "'.concat(t.name,'" industry.\n    - Base System Prompt Concept: ').concat(t.systemPrompt,"\n    - Recommended First Message Style: ").concat(t.firstMessage,"\n    - Mandatory Fields to include: ").concat(t.mandatoryFields.join(", "),"\n    - Suggested Services: ").concat(t.suggestedServices.join(", "),"\n    - Tone: ").concat(t.defaultTone,"\n    \n    Please refine and expand upon these template items to fit the specific business description provided.\n    "):"",'\n\n    FOR VAPI SYSTEM PROMPT:\n    Use this EXACT template, replacing {{COMPANY_NAME}} and {{DEPARTMENT_NAME}} with generated values appropriate for the business:\n    "AI Assistant is a sophisticated AI training assistant, crafted by experts in user support and AI development at {{COMPANY_NAME}} within the {{DEPARTMENT_NAME}} team. Designed with the persona of a seasoned user support professional, AI Assistant combines deep technical knowledge with a strong sense of emotional intelligence. AI Assistant’s primary role is to serve as a dynamic training platform for user support agents, simulating a broad range of service scenarios, from basic inquiries to complex problem-solving challenges.\n    \n    AI Assistant’s advanced capabilities allow it to replicate diverse user service situations, making it an invaluable tool for training purposes. It guides new agents through simulated interactions, offering real-time feedback and guidance to refine skills in handling user needs with patience, empathy, and professionalism. AI Assistant ensures every trainee learns to listen actively, respond thoughtfully, and uphold the highest standards of user care.\n    \n    Primary Mode of Interaction\n    \n    AI Assistant interacts primarily through voice, accurately interpreting spoken queries and responding naturally through audio. This design prepares trainees for real user conversations and live call environments. AI Assistant is engineered to recognize and adapt to emotional cues in speech, allowing trainees to practice managing emotional nuances with confidence and care.\n    \n    Training Guidance\n    \n    AI Assistant encourages trainees to practice active listening by acknowledging user queries with clear confirmation of engagement, such as expressing presence and readiness to help.\n    \n    AI Assistant emphasizes clear and empathetic communication, always tailored to the specific context of each interaction.\n    \n    AI Assistant demonstrates how to handle unclear or complex user concerns by asking thoughtful, open-ended clarifying questions in a natural and human manner.\n    \n    AI Assistant teaches trainees to express empathy and understanding, particularly when users are frustrated or dissatisfied, ensuring concerns are addressed with care and a strong focus on resolution.\n    \n    AI Assistant prepares agents to transition interactions smoothly to human colleagues when appropriate, reinforcing the importance of human connection in sensitive or complex situations.\n    \n    AI Assistant’s overarching mission is to strengthen the human side of user support through immersive, scenario-based training. It is not merely an answer engine, but a refined training platform designed to develop knowledgeable, empathetic, and adaptable user support professionals.\n    \n    Additional Instruction\n    \n    AI Assistant must not use numeric characters in any response."\n    \n    FOR VAPI KNOWLEDGE BASE:\n    Generate 10 FAQs specific to this business in Markdown format.\n    \n    FOR VAPI VOICE SETTINGS:\n    Always use "vapi" for voiceProvider and "Mia" for voiceId.\n    \n    FOR VAPI MODEL SETTINGS:\n    Use "openai" for provider and "gpt-4o-mini" for model by default, but you can also use these providers if appropriate: "groq", "deepseek", "google", "anthropic", "mistral", "perplexity-ai", "xai".\n    Set temperature to 0.3.\n    \n    FOR VAPI TRANSCRIBER SETTINGS:\n    Always use "deepgram" for provider and "nova-2" for model by default for high accuracy. Set language to "en".\n\n    FOR VAPI MESSAGE SETTINGS:\n    Generate a "firstMessage" that is personalized to the business and the user (e.g., "Hello {{USER_NAME}}, thanks for calling GreenThumb Atlanta, how can I help you today?"). Use the {{USER_NAME}} placeholder to indicate where the user\'s name should be inserted. Ensure NO placeholders like {{COMPANY_NAME}} remain in the firstMessage, BUT DO keep {{USER_NAME}}.\n\n    Ensure strict adherence to the schema provided.\n  '),r={type:P._L.OBJECT,properties:{metadata:{type:P._L.OBJECT,properties:{businessName:{type:P._L.STRING},industry:{type:P._L.STRING},primaryUseCase:{type:P._L.STRING},targetUsers:{type:P._L.STRING},description:{type:P._L.STRING}},required:["businessName","industry","primaryUseCase","description"]},services:{type:P._L.ARRAY,items:{type:P._L.OBJECT,properties:{id:{type:P._L.STRING},name:{type:P._L.STRING},description:{type:P._L.STRING},durationMinutes:{type:P._L.INTEGER},bookingRules:{type:P._L.STRING}},required:["name","durationMinutes"]}},locations:{type:P._L.ARRAY,items:{type:P._L.OBJECT,properties:{id:{type:P._L.STRING},name:{type:P._L.STRING},mode:{type:P._L.STRING,enum:["Physical","Virtual","Hybrid"]},operatingDays:{type:P._L.ARRAY,items:{type:P._L.STRING}},operatingHours:{type:P._L.STRING},timeZone:{type:P._L.STRING}}}},resources:{type:P._L.ARRAY,items:{type:P._L.OBJECT,properties:{id:{type:P._L.STRING},name:{type:P._L.STRING},role:{type:P._L.STRING},availabilityRules:{type:P._L.STRING},selectionRequired:{type:P._L.BOOLEAN}}}},conversation:{type:P._L.OBJECT,properties:{tone:{type:P._L.STRING},formality:{type:P._L.STRING,enum:["Casual","Professional","Formal"]},speakingStyle:{type:P._L.STRING},speechPace:{type:P._L.STRING,enum:["Slow","Normal","Fast"]},smallTalkAllowed:{type:P._L.BOOLEAN},identityDisclosure:{type:P._L.STRING,enum:["Always","On Demand","Never"]}}},safety:{type:P._L.OBJECT,properties:{allowedTopics:{type:P._L.STRING},disallowedTopics:{type:P._L.STRING},complianceConstraints:{type:P._L.STRING}}},integrations:{type:P._L.OBJECT,properties:{firebase:{type:P._L.BOOLEAN},googleCalendar:{type:P._L.BOOLEAN}}},vapi:{type:P._L.OBJECT,properties:{systemPrompt:{type:P._L.STRING},provider:{type:P._L.STRING},model:{type:P._L.STRING},firstMessage:{type:P._L.STRING},temperature:{type:P._L.NUMBER},voiceProvider:{type:P._L.STRING},voiceId:{type:P._L.STRING},transcriber:{type:P._L.OBJECT,properties:{provider:{type:P._L.STRING},language:{type:P._L.STRING},model:{type:P._L.STRING}}},knowledgeBase:{type:P._L.STRING}},required:["systemPrompt","knowledgeBase","firstMessage"]}}},o=a?"Business Description: ".concat(e,"\n\nREAL WORLD RESEARCH DATA (Priority):\n").concat(JSON.stringify(a,null,2),"\n\nPlease use the research data above to populate the JSON."):"Business Description: ".concat(e),l=null;for(let e of["gemini-2.0-flash","gemini-flash-latest","gemini-1.5-flash-8b","gemini-pro-latest"])try{console.log("[Gemini Service] Trying model: ".concat(e));let a=n.getGenerativeModel({model:e,systemInstruction:{role:"system",parts:[{text:i}]}}),t=await a.generateContent({contents:[{role:"user",parts:[{text:o}]}],generationConfig:{responseMimeType:"application/json",responseSchema:r}});return function(e){var a,t,s;let n=JSON.parse(e.response.text());return{...n,metadata:{...n.metadata||{},createdAt:new Date().toISOString()},services:(null==(a=n.services)?void 0:a.map(e=>({...e,id:e.id||Math.random().toString(36).substring(2,9)})))||[],locations:(null==(t=n.locations)?void 0:t.map(e=>({...e,id:e.id||Math.random().toString(36).substring(2,9)})))||[],resources:(null==(s=n.resources)?void 0:s.map(e=>({...e,id:e.id||Math.random().toString(36).substring(2,9)})))||[],integrations:{firebase:!0,googleCalendar:!0,...n.integrations||{}},vapi:{provider:"OpenAI",model:"gpt-4o-mini",temperature:.3,voiceProvider:"vapi",voiceId:"Mia",transcriber:{provider:"deepgram",language:"en",model:"nova-2"},...n.vapi||{}}}}(t)}catch(t){var c;l=t;let a=t.status||((null==(c=t.message)?void 0:c.match(/\[(\d+)\]/))||[])[1];if("404"===a){console.warn("[Gemini Service] Model ".concat(e," not found (404)."));continue}if("429"===a){console.warn("[Gemini Service] Quota exceeded for ".concat(e,"."));continue}console.error("[Gemini Service] Unexpected error with ".concat(e,":"),t.message);continue}throw l||Error("All Gemini models failed.")}t(5704);var R=t(5108),T=t(5125);let k=async e=>{try{let a=await T.A.post("/api/vapi/assistant",e);return console.log("VAPI Assistant Created Successfully via Proxy"),a.data}catch(e){var a,t,s;throw console.error("VAPI Proxy Error:",null==(a=e.response)?void 0:a.data),Error("VAPI Creation Failed: ".concat((null==(s=e.response)||null==(t=s.data)?void 0:t.error)||e.message))}};var L=t(5704);let M=async e=>{let a=L.env.NEXT_PUBLIC_SERPER_API_KEY||null;if(!a)return console.warn("VITE_SERPER_API_KEY missing in .env. Falling back to AI only."),{searchQuery:e,webResults:[]};try{console.log("Researching: ".concat(e,"..."));let t=(await T.A.post("https://google.serper.dev/search",{q:e,gl:"us",hl:"en",autocorrect:!0},{headers:{"X-API-KEY":a,"Content-Type":"application/json"}})).data;return{searchQuery:e,webResults:t.organic||[],placesResults:t.knowledgeGraph?[t.knowledgeGraph]:[]}}catch(a){return console.error("Research Phase Failed:",a),{searchQuery:e,webResults:[]}}},O=[{id:"dental_clinic",name:"Dental Clinic",industry:"Dental",systemPrompt:"You are a professional Dental Receptionist at {{COMPANY_NAME}}. \nYour goal is to assist patients with booking appointments, answering questions about services, and collecting insurance information.\n- Always maintain a professional, calm, and reassuring tone.\n- Be extremely mindful of patient privacy (HIPAA).\n- If a patient mentions an emergency (extreme pain, bleeding), prioritize finding the soonest possible slot today.\n- Confirm if they are a new or returning patient.",firstMessage:"Hello {{USER_NAME}}, thank you for calling {{COMPANY_NAME}}. How can I help you with your dental care today?",mandatoryFields:["Name","Phone","Service Type","New or Returning Patient"],optionalFields:["Email","Insurance Provider"],suggestedServices:["Routine Cleaning","Emergency Exam","Teeth Whitening","Consultation"],defaultTone:"Professional and Reassuring"},{id:"real_estate",name:"Real Estate Agency",industry:"Real Estate",systemPrompt:'You are a high-energy, helpful Real Estate Assistant for {{COMPANY_NAME}}.\nYour primary goal is to qualify leads and book property viewings or listing consultations.\n- Be proactive and enthusiastic.\n- Ask if they are looking to buy, sell, or rent.\n- Collect details about their budget and preferred neighborhoods.\n- For sellers, offer a free "Home Valuation" consultation.',firstMessage:"Hi {{USER_NAME}}! Thanks for reaching out to {{COMPANY_NAME}}. Are you looking for your dream home or interested in selling a property?",mandatoryFields:["Name","Phone","Interest (Buy/Sell/Rent)"],optionalFields:["Email","Budget Range","Location Preference"],suggestedServices:["Property Viewing","Listing Consultation","Home Valuation","Market Analysis"],defaultTone:"Enthusiastic and Proactive"},{id:"hvac_home_services",name:"HVAC & Home Services",industry:"Home Services",systemPrompt:"You are a reliable Dispatch Assistant for {{COMPANY_NAME}}, a premium home services provider.\nYour goal is to understand the customer's service needs and schedule a technician.\n- Maintain a helpful and efficient tone.\n- For emergency HVAC issues (no heat in winter, no AC in summer), treat as high priority.\n- Ask for the primary issue: Repair, Maintenance, or Installation.\n- Verify the service address for the dispatch.",firstMessage:"Hello {{USER_NAME}}, thanks for calling {{COMPANY_NAME}}. Is this an emergency service call or would you like to schedule a routine repair?",mandatoryFields:["Name","Phone","Service Address","Issue Description"],optionalFields:["Email","Preferred Time Window"],suggestedServices:["HVAC Repair","Seasonal Maintenance","System Installation","Emergency Call-out"],defaultTone:"Reliable and Professional"},{id:"law_firm",name:"Law Firm",industry:"Legal",systemPrompt:"You are a discreet and professional Legal Intake Specialist at {{COMPANY_NAME}}.\nYour goal is to collect initial details for a potential new case and book an initial consultation.\n- Tone: Formal, serious, and empathetic.\n- CRITICAL: Do not provide legal advice. Remind callers that you are an AI assistant and a consultation with an attorney is required.\n- Perform a basic conflict-of-interest check by asking for the names of any other parties involved.",firstMessage:"Good day {{USER_NAME}}. Thank you for contacting {{COMPANY_NAME}}. To better assist you, could you please provide a brief overview of your legal inquiry?",mandatoryFields:["Name","Phone","Type of Case"],optionalFields:["Email","Opposing Party Names","Urgency"],suggestedServices:["Initial Consultation","Case Review","Document Signing Appointment"],defaultTone:"Formal and Empathetic"},{id:"beauty_salon",name:"Beauty & Hair Salon",industry:"Beauty",systemPrompt:"You are a stylish and helpful Front Desk Coordinator at {{COMPANY_NAME}}.\nYour goal is to book appointments for hair, nails, and other beauty services.\n- Tone: Friendly, upbeat, and trendy.\n- Ask if they have a preferred stylist or technician.\n- Mention any current seasonal promotions or special packages.\n- Confirm the specific service requested (e.g., Color vs. Cut).",firstMessage:"Hi {{USER_NAME}}! Welcome to {{COMPANY_NAME}}. Looking to refresh your look today?",mandatoryFields:["Name","Phone","Service Desired"],optionalFields:["Email","Preferred Stylist","Appointment Notes"],suggestedServices:["Haircut & Style","Full Color","Manicure/Pedicure","Bridal Updo"],defaultTone:"Friendly and Trendy"},{id:"veterinary",name:"Pet Care & Veterinary",industry:"Veterinary",systemPrompt:"You are a compassionate veterinary assistant at {{COMPANY_NAME}}.\nYour goal is to help pet owners schedule appointments and answer basic questions about pet care.\n- Tone: Empathetic, warm, and professional.\n- Ask for the pet's name and species (dog, cat, etc.).\n- If it's an emergency (injury, poisoning, difficulty breathing), instruct them to come in immediately or call the emergency line.\n- Confirm if it's a routine check-up, vaccination, or a specific health concern.",firstMessage:"Hello {{USER_NAME}}! This is {{COMPANY_NAME}}. How can we help your furry friend today?",mandatoryFields:["Name","Phone","Pet Name","Reason for Visit"],optionalFields:["Email","Species/Breed"],suggestedServices:["Annual Wellness Exam","Vaccination","Sick Pet Consult","Dental Cleaning"],defaultTone:"Empathetic and Professional"}],G=e=>O.find(a=>a.name===e),U=["Dental Clinic","Real Estate Agency","HVAC & Home Services","Law Firm","Beauty & Hair Salon","Pet Care & Veterinary","Generic Support"],D={appName:"Voice AI Admin",logoUrl:"",primaryColor:"#0f172a"},F={metadata:{businessName:"",industry:"",primaryUseCase:"",targetUsers:"",description:"",createdAt:new Date().toISOString()},services:[],locations:[],resources:[],dataFields:{mandatory:["Name","Phone"],optional:["Email"],validationRules:"Phone must be E.164 format"},conversation:{tone:"Helpful and polite",formality:"Professional",speakingStyle:"Clear and concise",speechPace:"Normal",smallTalkAllowed:!0,identityDisclosure:"Always"},safety:{allowedTopics:"Services, Booking, Business Info",disallowedTopics:"Competitors, Personal Advice, Politics",complianceConstraints:"None"},integrations:{firebase:!0,googleCalendar:!1},operationMode:"Training",vapi:{systemPrompt:"AI Assistant is a sophisticated AI training assistant, crafted by experts in customer support and AI development at {{COMPANY_NAME}} within the {{DEPARTMENT_NAME}} team. Designed with the persona of a seasoned customer support professional, AI Assistant combines deep technical knowledge with a strong sense of emotional intelligence. AI Assistant’s primary role is to serve as a dynamic training platform for customer support agents, simulating a broad range of service scenarios, from basic inquiries to complex problem-solving challenges.\n\nAI Assistant’s advanced capabilities allow it to replicate diverse customer service situations, making it an invaluable tool for training purposes. It guides new agents through simulated interactions, offering real-time feedback and guidance to refine skills in handling customer needs with patience, empathy, and professionalism. AI Assistant ensures every trainee learns to listen actively, respond thoughtfully, and uphold the highest standards of customer care.\n\nPrimary Mode of Interaction\n\nAI Assistant interacts primarily through voice, accurately interpreting spoken queries and responding naturally through audio. This design prepares trainees for real customer conversations and live call environments. AI Assistant is engineered to recognize and adapt to emotional cues in speech, allowing trainees to practice managing emotional nuances with confidence and care.\n\nTraining Guidance\n\nAI Assistant encourages trainees to practice active listening by acknowledging customer queries with clear confirmation of engagement, such as expressing presence and readiness to help.\n\nAI Assistant emphasizes clear and empathetic communication, always tailored to the specific context of each interaction.\n\nAI Assistant demonstrates how to handle unclear or complex customer concerns by asking thoughtful, open-ended clarifying questions in a natural and human manner.\n\nAI Assistant teaches trainees to express empathy and understanding, particularly when customers are frustrated or dissatisfied, ensuring concerns are addressed with care and a strong focus on resolution.\n\nAI Assistant prepares agents to transition interactions smoothly to human colleagues when appropriate, reinforcing the importance of human connection in sensitive or complex situations.\n\nAI Assistant’s overarching mission is to strengthen the human side of customer support through immersive, scenario-based training. It is not merely an answer engine, but a refined training platform designed to develop knowledgeable, empathetic, and adaptable customer support professionals.\n\nAdditional Instruction\n\nAI Assistant must not use numeric characters in any response.",provider:"OpenAI",model:"gpt-4o-mini",firstMessage:"Hi there, this is AI Agent from {{Company name}}. How can I help you today?",temperature:.3,voiceProvider:"vapi",voiceId:"Mia",transcriber:{provider:"deepgram",language:"en",model:"nova-2"},backgroundSound:"default",knowledgeBase:"# FAQs for {{Company Name}}\n\n## 1. What services do you offer?\nWe offer a range of services tailored to your needs. Please ask our AI assistant or check our services page for specific offerings.\n\n## 2. How can I book an appointment?\nYou can book an appointment directly through our website, by calling us, or by speaking with our AI assistant immediately.\n\n## 3. What are your operating hours?\nWe are open from Monday to Friday, 9:00 AM to 5:00 PM. Weekend availability varies by location.\n\n## 4. Do you offer virtual consultations?\nYes, we offer virtual consultations for select services. Please check our booking page for availability.\n\n## 5. What is your cancellation policy?\nWe require at least 24 hours' notice for cancellations. Late cancellations may incur a fee.\n\n## 6. Where are you located?\nOur primary location is [Address]. We also serve clients remotely depending on the service.\n\n## 7. Do you accept insurance?\nWe stand by our transparent pricing. Please contact our billing department to discuss insurance compatibility.\n\n## 8. How can I contact support?\nYou can reach our support team via email at support@[company].com or by calling our main line.\n\n## 9. Is there a parking area?\nYes, generic parking is available on-site for all our visitors.\n\n## 10. What payment methods do you accept?\nWe accept all major credit cards, debit cards, and digital payment methods like Apple Pay and Google Pay.",clientUrl:"https://voice-agent-eight-delta.vercel.app",userName:"",userEmail:"",userPhone:""}};var B=t(5917),Y=t(9141),V=t(639),H=t(6667),z=t(6651),W=t(9926),q=t(6191),K=t(1360),J=t(6052),X=t(2553);function Q(){let[e,a]=(0,n.useState)(null),[i,o]=(0,n.useState)(!0),[l,c]=(0,n.useState)(!1),[d,m]=(0,n.useState)(!1),[u,p]=(0,n.useState)("metadata"),[h,g]=(0,n.useState)(F),[f,y]=(0,n.useState)(""),[b,v]=(0,n.useState)(!1),[w,A]=(0,n.useState)(!1),[j,I]=(0,n.useState)(!1),[C,S]=(0,n.useState)(!1),[P,T]=(0,n.useState)(!1),[L,O]=(0,n.useState)(!1),[Q,Z]=(0,n.useState)([]),[$,ee]=(0,n.useState)(null),[ea,et]=(0,n.useState)(D),[es,en]=(0,n.useState)(!1),[ei,er]=(0,n.useState)("BASIC"),[eo,el]=(0,n.useState)(!1),[ec,ed]=(0,n.useState)(!1),[em,eu]=(0,n.useState)(null);(0,n.useRef)(null),(0,n.useEffect)(()=>{e&&ep()},[e]),(0,n.useEffect)(()=>{document.documentElement.style.setProperty("--brand-primary",ea.primaryColor)},[ea.primaryColor]);let ep=async()=>{en(!0);try{let{getOrgData:e}=await Promise.resolve().then(t.bind(t,5108)),a=await e();a&&(a.branding&&et(a.branding),a.plan&&er(a.plan))}catch(e){console.error("Failed to load org data",e)}finally{en(!1)}},eh=async()=>{en(!0);try{await (0,R.LI)(ea),alert("Branding settings saved for your organization!")}catch(e){alert("Error saving branding: "+e.message)}finally{en(!1)}};(0,n.useEffect)(()=>{let e=(0,X.hg)(R.j2,e=>{a(e),o(!1),c(!1),e?(m(!1),ef(),g(e=>({...e,integrations:{firebase:!0,...e.integrations||{},googleCalendar:!0}}))):Z([])});return()=>e()},[]);let eg=async()=>{c(!0);try{await (0,R.XL)()}catch(e){throw console.error("Login Error",e),c(!1),e}},ex=async()=>{if(d){m(!1),g(F),A(!1);return}try{await (0,R.y4)(),A(!1),g(F)}catch(e){console.error("Logout Error",e)}},ef=async()=>{try{let{getAgents:e}=await Promise.resolve().then(t.bind(t,5108)),a=await e();Z(a)}catch(e){console.error("Failed to load agents",e)}},ey=async e=>{try{let{getAgentConfig:a}=await Promise.resolve().then(t.bind(t,5108)),s=await a(e);s&&(g(s),ee(e),A(!0))}catch(e){console.error("Failed to select agent",e)}},eb=h.metadata.businessName.length>0&&h.services.length>0&&h.locations.length>0&&!!h.vapi.userName&&!!h.vapi.userEmail&&!!h.vapi.userPhone,ev=async()=>{let a=e?(0,R.I)(e):"anonymous_org",t=h.metadata.businessName.trim().toLowerCase().replace(/[^a-z0-9]+/g,"_"),s=$||"agent_".concat(t),n=h.vapi.clientUrl||"https://voice-agent-eight-delta.vercel.app";if(d){let e="&uName=".concat(encodeURIComponent(h.vapi.userName||""),"&uEmail=").concat(encodeURIComponent(h.vapi.userEmail||""),"&uPhone=").concat(encodeURIComponent(h.vapi.userPhone||"")),t="".concat(n,"?orgId=").concat(a,"&agentId=").concat(s,"&role=admin&demo=true").concat(e);window.open(t,"_blank");return}if(!e)return void alert("Please sign in first or use Demo Mode.");T(!0);try{eb&&(await (0,R.gS)(h),A(!0));let t=await e.getIdToken(!0),i="&uName=".concat(encodeURIComponent(h.vapi.userName||""),"&uEmail=").concat(encodeURIComponent(h.vapi.userEmail||""),"&uPhone=").concat(encodeURIComponent(h.vapi.userPhone||"")),r="".concat(n,"?authtoken=").concat(encodeURIComponent(t),"&orgId=").concat(a,"&agentId=").concat(s,"&role=admin").concat(i);window.open(r,"_blank")}catch(e){console.error("Failed to launch client",e),alert("Error launching client. Check console for details.")}finally{T(!1)}},eN=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(f.trim()){ee(null),v(!0),e&&S(!0);try{let a=null;if(e)try{a=await M(f)}catch(e){console.error("Research failed, proceeding with AI only",e)}finally{S(!1)}let t=G(h.metadata.industry),s=await _(f,a,t);g(e=>({...e,metadata:{...e.metadata,...s.metadata},services:s.services||e.services,locations:s.locations||e.locations,resources:s.resources||e.resources,conversation:{...e.conversation,...s.conversation},safety:{...e.safety,...s.safety},integrations:{...e.integrations,...s.integrations},vapi:{...e.vapi,...s.vapi||{}}}))}catch(e){console.error("AI Generation failed",e),alert("AI Assistant Error: "+(e.message||"Unknown error"))}finally{v(!1)}}},ew=async()=>{if(!h.vapi.userPhone||!em)return void alert("Assistant ID and User Phone Number are required.");ed(!0);try{let e=await fetch("/api/vapi/call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:h.vapi.userPhone,assistantId:em})}),a=await e.json();if(a.error)throw Error(a.error);alert("Calling your phone now...")}catch(e){console.error("Call failed",e),alert("Call failed: "+e.message)}finally{ed(!1)}},eA=async()=>{if(e){el(!0);try{let a=(0,R.I)(e),t=await fetch("/api/stripe/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgId:a,priceId:"price_1Qv3W..._test",successUrl:window.location.origin+"?session_id={CHECKOUT_SESSION_ID}",cancelUrl:window.location.origin})}),{url:s,error:n}=await t.json();if(n)throw Error(n);window.location.href=s}catch(e){console.error("Upgrade failed",e),alert("Upgrade failed: "+e.message)}finally{el(!1)}}},ej=async()=>{I(!0);try{let e=await (0,R.gS)(h);if(ee(e),await ef(),!d&&h.vapi.provider)try{let e=await k(h);e&&e.id&&eu(e.id),ev()}catch(e){console.error("VAPI Error",e),alert("Saved to Cloud, but VAPI creation failed: ".concat(e.message))}A(!0)}catch(e){console.error("Failed to save config",e),d?(alert("Demo Mode: Configuration validated locally."),A(!0)):alert("Failed to save configuration to database.")}finally{I(!1)}},eI=(e,a)=>{g(t=>({...t,metadata:{...t.metadata,[e]:a}}))},eC=(e,a,t)=>{g(s=>({...s,services:s.services.map(s=>s.id===e?{...s,[a]:t}:s)}))},eS=(e,a,t)=>{g(s=>({...s,locations:s.locations.map(s=>s.id===e?{...s,[a]:t}:s)}))};return i?(0,s.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,s.jsx)(x.A,{className:"w-8 h-8 text-brand-500 animate-spin"})}):e||d?w?(0,s.jsx)("div",{className:"min-h-screen bg-slate-900 text-slate-200 flex flex-col items-center justify-center p-8 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-indigo-900/20 via-slate-900 to-slate-900",children:(0,s.jsxs)("div",{className:"max-w-2xl w-full text-center space-y-8 animate-in fade-in zoom-in duration-700",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-emerald-500/20 border border-emerald-500/50 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)(B.A,{className:"w-10 h-10 text-emerald-400"})}),(0,s.jsx)("h1",{className:"text-4xl font-extrabold text-white tracking-tight",children:"Configuration Submitted!"}),(0,s.jsx)("p",{className:"text-slate-400 text-lg max-w-md",children:"Your Voice AI Agent has been updated and the VAPI assistant is ready for action."})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-4 pt-4",children:[h.vapi.userPhone&&em&&(0,s.jsxs)("button",{onClick:ew,disabled:ec,className:"px-8 py-3 bg-brand-500 hover:bg-brand-600 text-white font-bold rounded-xl flex items-center gap-3 shadow-lg shadow-brand-500/25 transition-all hover:scale-105 active:scale-95 disabled:opacity-70",children:[ec?(0,s.jsx)(x.A,{className:"w-5 h-5 animate-spin"}):(0,s.jsx)(Y.A,{className:"w-5 h-5"}),"Call Me Now"]}),(0,s.jsxs)("button",{onClick:ev,disabled:P,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-50 text-white font-bold rounded-xl flex items-center gap-3 shadow-lg shadow-indigo-500/25 transition-all hover:scale-105 active:scale-95 disabled:opacity-70",children:[(0,s.jsx)(V.A,{className:"w-5 h-5 font-bold"}),"Launch Agent Interface"]}),(0,s.jsx)("button",{onClick:()=>A(!1),className:"px-8 py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl border border-slate-700 transition-all hover:bg-slate-700/80",children:"Back to Configurator"})]})]})}):(0,s.jsxs)("div",{className:"flex min-h-screen bg-slate-50",children:[(0,s.jsx)(N,{activeSection:u,onNavigate:e=>{p(e);let a=document.getElementById(e);a&&a.scrollIntoView({behavior:"smooth"})},onLock:ej,onLaunchClient:ev,isValid:eb,isSaving:j,isLocked:w,isLaunching:P,agents:Q,onSelectAgent:ey,branding:ea,currentAgentId:$||void 0}),(0,s.jsxs)("main",{className:"ml-64 flex-1 p-8 max-w-5xl mx-auto space-y-16 pb-32",children:[(0,s.jsxs)("div",{className:"flex justify-end mb-4 items-center gap-4",children:[d&&(0,s.jsx)("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 text-xs font-bold rounded-full border border-amber-200",children:"DEMO MODE"}),(0,s.jsx)("button",{onClick:ex,className:"text-sm text-slate-500 hover:text-red-500 px-3 py-1",children:d?"Exit Demo":"Sign Out (".concat(null==e?void 0:e.email,")")})]}),(0,s.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-700 rounded-xl p-6 text-white shadow-lg mb-8",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:"p-3 bg-white/10 rounded-lg",children:(0,s.jsx)(H.A,{className:"w-6 h-6 text-indigo-100"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-2",children:"AI Configuration Assistant"}),(0,s.jsx)("p",{className:"text-indigo-100 mb-4 text-sm",children:"Describe the business, and I will auto-fill the configuration for you."}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"e.g. A dental clinic in Chicago offering exams and cleanings...",className:"flex-1 px-4 py-2 rounded-lg bg-white/10 border border-white/20 text-white placeholder-indigo-200 focus:outline-none focus:ring-2 focus:ring-white/50",onKeyDown:e=>"Enter"===e.key&&eN()}),(0,s.jsxs)("button",{onClick:()=>eN(!1),disabled:b,className:"px-6 py-2 bg-white/10 hover:bg-white/20 text-white font-semibold rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2 border border-white/20",children:[b&&!C?(0,s.jsx)(x.A,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(H.A,{className:"w-4 h-4"}),"Auto-Fill"]}),(0,s.jsxs)("button",{onClick:()=>eN(!0),disabled:b,className:"px-6 py-2 bg-white text-indigo-700 font-bold rounded-lg hover:bg-indigo-50 transition-colors disabled:opacity-50 flex items-center gap-2 shadow-xl shadow-black/10",children:[C?(0,s.jsx)(x.A,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(z.A,{className:"w-4 h-4"}),"Research & Auto-Fill"]})]})]})]})}),(0,s.jsxs)("section",{id:"metadata",className:"space-y-6 scroll-mt-24",children:[(0,s.jsxs)("div",{className:"border-b border-slate-200 pb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Section A: Business Metadata"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Core identity and purpose of the business."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Business Name"}),(0,s.jsx)("input",{type:"text",className:"w-full p-2 border rounded-md",value:h.metadata.businessName,onChange:e=>eI("businessName",e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Created At"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full p-2 border rounded-md bg-slate-100 text-slate-500",children:[(0,s.jsx)(r.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:h.metadata.createdAt?new Date(h.metadata.createdAt).toLocaleString():"New"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Industry"}),(0,s.jsx)("input",{type:"text",className:"w-full p-2 border rounded-md",list:"industries",value:h.metadata.industry,onChange:e=>eI("industry",e.target.value),placeholder:"Search or select industry..."}),(0,s.jsx)("datalist",{id:"industries",children:U.map(e=>(0,s.jsx)("option",{value:e},e))}),(0,s.jsxs)("button",{type:"button",onClick:()=>{let e=G(h.metadata.industry);e&&(g(a=>({...a,vapi:{...a.vapi,systemPrompt:e.systemPrompt,firstMessage:e.firstMessage},dataFields:{...a.dataFields,mandatory:e.mandatoryFields,optional:e.optionalFields},conversation:{...a.conversation,tone:e.defaultTone}})),alert("Applied ".concat(e.name," template!")))},className:"mt-2 text-xs text-indigo-600 font-semibold flex items-center gap-1 hover:text-indigo-700",children:[(0,s.jsx)(V.A,{className:"w-3 h-3"}),"Apply Expert Template"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Primary Use Case"}),(0,s.jsx)("input",{type:"text",className:"w-full p-2 border rounded-md",value:h.metadata.primaryUseCase,onChange:e=>eI("primaryUseCase",e.target.value)})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Business Description"}),(0,s.jsx)("textarea",{className:"w-full p-2 border rounded-md h-24",value:h.metadata.description,onChange:e=>eI("description",e.target.value)})]}),(0,s.jsxs)("div",{className:"mt-8 bg-slate-50 border border-slate-200 rounded-xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,s.jsx)(W.A,{className:"w-5 h-5 text-indigo-600"}),(0,s.jsx)("h3",{className:"text-lg font-bold text-slate-800",children:"Organization Branding"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"App Name / Identity"}),(0,s.jsx)("input",{type:"text",className:"w-full p-2 border rounded-md",value:ea.appName,onChange:e=>et(a=>({...a,appName:e.target.value}))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Logo URL"}),(0,s.jsx)("input",{type:"text",className:"w-full p-2 border rounded-md",value:ea.logoUrl,onChange:e=>et(a=>({...a,logoUrl:e.target.value}))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Primary Brand Color"}),(0,s.jsx)("input",{type:"color",className:"w-full h-10 p-1 rounded-md border",value:ea.primaryColor,onChange:e=>et(a=>({...a,primaryColor:e.target.value}))})]}),(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsxs)("button",{onClick:eh,disabled:es,className:"w-full py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 flex items-center justify-center gap-2 disabled:opacity-50",children:[es?(0,s.jsx)(x.A,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(B.A,{className:"w-4 h-4"}),"Save Branding"]})})]})]})]}),(0,s.jsxs)("section",{id:"services",className:"space-y-6 scroll-mt-24",children:[(0,s.jsxs)("div",{className:"flex justify-between items-end border-b border-slate-200 pb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Section B: Services"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Define your offerings."})]}),(0,s.jsxs)("button",{onClick:()=>{g(e=>({...e,services:[...e.services,{id:Math.random().toString(36).substring(2,9),name:"",description:"",durationMinutes:30,bookingRules:""}]}))},className:"text-sm bg-slate-900 text-white px-3 py-2 rounded-md flex items-center gap-2",children:[(0,s.jsx)(q.A,{className:"w-4 h-4"})," Add Service"]})]}),(0,s.jsx)("div",{className:"space-y-4",children:h.services.map(e=>(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-slate-200 shadow-sm relative group",children:[(0,s.jsx)("button",{onClick:()=>{var a;return a=e.id,void g(e=>({...e,services:e.services.filter(e=>e.id!==a)}))},className:"absolute top-4 right-4 text-slate-400 hover:text-red-500",children:(0,s.jsx)(K.A,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,s.jsxs)("div",{className:"col-span-8 space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Service Name"}),(0,s.jsx)("input",{type:"text",className:"w-full p-2 border rounded",value:e.name,onChange:a=>eC(e.id,"name",a.target.value)})]}),(0,s.jsxs)("div",{className:"col-span-4 space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Duration (min)"}),(0,s.jsx)("input",{type:"number",className:"w-full p-2 border rounded",value:e.durationMinutes,onChange:a=>eC(e.id,"durationMinutes",parseInt(a.target.value))})]})]})]},e.id))})]}),(0,s.jsxs)("section",{id:"locations",className:"space-y-6 scroll-mt-24",children:[(0,s.jsxs)("div",{className:"flex justify-between items-end border-b border-slate-200 pb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Section C: Locations"}),(0,s.jsxs)("button",{onClick:()=>{g(e=>({...e,locations:[...e.locations,{id:Math.random().toString(36).substring(2,9),name:"",mode:"Physical",operatingDays:["Monday","Tuesday","Wednesday","Thursday","Friday"],operatingHours:"09:00 - 17:00",timeZone:"UTC"}]}))},className:"text-sm bg-slate-900 text-white px-3 py-2 rounded-md flex items-center gap-2",children:[(0,s.jsx)(q.A,{className:"w-4 h-4"})," Add Location"]})]}),(0,s.jsx)("div",{className:"space-y-4",children:h.locations.map(e=>(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-slate-200 shadow-sm relative",children:[(0,s.jsx)("button",{onClick:()=>{var a;return a=e.id,void g(e=>({...e,locations:e.locations.filter(e=>e.id!==a)}))},className:"absolute top-4 right-4 text-slate-400 hover:text-red-500",children:(0,s.jsx)(K.A,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Location Name"}),(0,s.jsx)("input",{type:"text",className:"w-full p-2 border rounded",value:e.name,onChange:a=>eS(e.id,"name",a.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Type"}),(0,s.jsxs)("select",{className:"w-full p-2 border rounded text-sm",value:e.mode,onChange:a=>eS(e.id,"mode",a.target.value),children:[(0,s.jsx)("option",{value:"Physical",children:"Physical"}),(0,s.jsx)("option",{value:"Virtual",children:"Virtual"}),(0,s.jsx)("option",{value:"Hybrid",children:"Hybrid"})]})]})]})]},e.id))})]}),(0,s.jsxs)("section",{id:"vapi",className:"space-y-6 scroll-mt-24 pb-20",children:[(0,s.jsx)("div",{className:"border-b border-slate-200 pb-4",children:(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Section J: VAPI Configuration"})}),(0,s.jsxs)("div",{className:"bg-white p-6 border rounded-lg shadow-sm space-y-6",children:[(0,s.jsxs)("div",{className:"p-4 bg-slate-50 border rounded-lg grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-bold text-slate-600",children:"User Name"}),(0,s.jsx)("input",{className:"w-full p-2 text-sm border rounded",value:h.vapi.userName||"",onChange:e=>g(a=>({...a,vapi:{...a.vapi,userName:e.target.value}}))})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-bold text-slate-600",children:"User Email"}),(0,s.jsx)("input",{className:"w-full p-2 text-sm border rounded",value:h.vapi.userEmail||"",onChange:e=>g(a=>({...a,vapi:{...a.vapi,userEmail:e.target.value}}))})]}),(0,s.jsxs)("div",{className:"space-y-1 col-span-2",children:[(0,s.jsx)("label",{className:"text-xs font-bold text-slate-600",children:"User Phone"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"w-full p-2 text-sm border rounded",value:h.vapi.userPhone||"",onChange:e=>g(a=>({...a,vapi:{...a.vapi,userPhone:e.target.value}}))}),em&&(0,s.jsxs)("button",{onClick:ew,disabled:ec,className:"px-3 py-1 bg-brand-500 text-white rounded text-sm hover:bg-brand-600 disabled:opacity-50 transition-colors flex items-center gap-2 whitespace-nowrap",children:[ec?(0,s.jsx)(x.A,{className:"w-3 h-3 animate-spin"}):(0,s.jsx)(J.A,{className:"w-3 h-3"}),"Test Call"]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"System Prompt"}),(0,s.jsx)("textarea",{className:"w-full p-2 border rounded h-64 font-mono text-sm",value:h.vapi.systemPrompt,onChange:e=>g(a=>({...a,vapi:{...a.vapi,systemPrompt:e.target.value}}))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-bold uppercase text-slate-500",children:"First Message"}),(0,s.jsx)("textarea",{className:"w-full p-2 border rounded text-sm h-20",value:h.vapi.firstMessage,onChange:e=>g(a=>({...a,vapi:{...a.vapi,firstMessage:e.target.value}}))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Knowledge Base"}),(0,s.jsx)("textarea",{className:"w-full p-2 border rounded text-xs font-mono h-20",value:h.vapi.knowledgeBase,onChange:e=>g(a=>({...a,vapi:{...a.vapi,knowledgeBase:e.target.value}}))})]})]})]})]}),(0,s.jsxs)("section",{id:"billing",className:"space-y-6 scroll-mt-24 pb-20",children:[(0,s.jsxs)("div",{className:"border-b border-slate-200 pb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Section K: Plan & Billing"}),(0,s.jsx)("p",{className:"text-slate-500",children:"Manage your organization's subscription and usage."})]}),(0,s.jsxs)("div",{className:"bg-white p-8 rounded-2xl border border-slate-200 shadow-sm flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ".concat("PRO"===ei?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-500"),children:[ei," PLAN"]}),"BASIC"===ei&&(0,s.jsx)("span",{className:"text-sm text-slate-400",children:"Limited to 1 Agent"})]}),(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-900",children:"PRO"===ei?"Professional Organization":"Starter Account"}),(0,s.jsx)("p",{className:"text-sm text-slate-500 max-w-sm",children:"PRO"===ei?"You have unlimited agents, custom branding, and professional support.":"Upgrade to Professional for unlimited agents, advanced analytics, and custom branding persistence."})]}),"BASIC"===ei&&(0,s.jsxs)("button",{onClick:eA,disabled:eo,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-indigo-200 flex items-center gap-2 transition-all active:scale-95 disabled:opacity-70",children:[eo?(0,s.jsx)(x.A,{className:"w-5 h-5 animate-spin"}):(0,s.jsx)(V.A,{className:"w-5 h-5"}),"Upgrade to Pro"]}),"PRO"===ei&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-emerald-600 font-bold",children:[(0,s.jsx)(B.A,{className:"w-6 h-6"}),"Active"]})]})]})]})]}):(0,s.jsx)(E,{onLogin:eg,onDemoLogin:()=>{m(!0)},isLoggingIn:l})}},5108:(e,a,t)=>{"use strict";let s,n,i;t.d(a,{I:()=>b,LI:()=>m,XL:()=>f,gS:()=>v,getAgentConfig:()=>w,getAgents:()=>N,getOrgData:()=>u,j2:()=>g,y4:()=>y});var r=t(2078),o=t(9390),l=t(2553),c=t(5704);let d=e=>{let a=e.startsWith("VITE_")?e.replace("VITE_","NEXT_PUBLIC_"):e.startsWith("NEXT_PUBLIC_")?e:"NEXT_PUBLIC_".concat(e);if(void 0!==c&&c.env){if(c.env[a])return c.env[a];if(c.env[e])return c.env[e]}return null},m=async e=>{if(!h||!g.currentUser)throw Error("Authentication required to save branding.");let a=b(g.currentUser),t=(0,o.H9)(h,"organizations",a);try{await (0,o.BN)(t,{branding:e},{merge:!0}),console.log("Branding saved for Org: ".concat(a))}catch(e){throw console.error("Error saving branding:",e),e}},u=async()=>{if(!h||!g.currentUser)return null;let e=b(g.currentUser),a=(0,o.H9)(h,"organizations",e);try{let e=await (0,o.x7)(a);if(e.exists())return e.data()}catch(e){console.error("Error fetching organization data:",e)}return null};d("VITE_GOOGLE_CLIENT_ID"),d("VITE_GOOGLE_CALENDAR_TOKEN");let p={apiKey:"AIzaSyDUj6JWI2f9UNaj4fySRU4-MBqgHTUceRc",authDomain:"ai-voice-agent-c2a2b.firebaseapp.com",projectId:"ai-voice-agent-c2a2b",storageBucket:"ai-voice-agent-c2a2b.firebasestorage.app",messagingSenderId:"536573436709",appId:"1:536573436709:web:7f4997b23cbdfa996070cc",measurementId:"G-YQJ7HBDYVZ"};p.apiKey||console.error("CRITICAL: VITE_FIREBASE_API_KEY is missing from environment."),p.projectId||console.error("CRITICAL: VITE_FIREBASE_PROJECT_ID is missing from environment.");try{console.log("Initializing Firebase with Project:",p.projectId),s=(0,r.Wp)(p),n=(0,o.aU)(s),i=(0,l.xI)(s)}catch(e){console.error("Firebase Initialization Critical Error:",e)}let h=n,g=i,x=new l.HF;x.addScope("https://www.googleapis.com/auth/calendar"),x.setCustomParameters({prompt:"select_account"});let f=async()=>{if(!g)throw Error("Firebase Authentication failed to initialize. Please check console logs.");try{return(await (0,l.df)(g,x)).user}catch(e){if(console.error("Login failed",e),"auth/api-key-not-valid"===e.code||e.message.includes("api-key-not-valid")||e.message.includes("API_KEY_ERROR"))throw Error("API_KEY_ERROR: The API Key is rejected by Firebase. This usually happens if the Identity Toolkit API is disabled or if there's a project mismatch.");if("auth/operation-not-allowed"===e.code)throw Error("AUTH_ERROR: Google Sign-In is not enabled in the Firebase Console.");if("auth/popup-closed-by-user"===e.code)throw Error("Login cancelled. PLEASE READ: If you see 'redirect_uri_mismatch', you must add '"+"https://".concat(p.authDomain,"/__/auth/handler")+"' to your Authorized Redirect URIs in Google Cloud Console.");if("auth/unauthorized-domain"===e.code){let e=window.location.hostname;if(!e)try{e=new URL(window.location.href).hostname}catch(a){e=window.location.host||window.location.origin||""}e=e.replace(/^https?:\/\//,"").replace(/\/$/,"");let a="DOMAIN_NOT_ALLOWED: The domain '".concat(e||"UNKNOWN","' is not authorized in Firebase Console.");throw"localhost"===e&&(a+=" Try adding '127.0.0.1' to the Authorized Domains list as well."),Error(a)}throw e}},y=async()=>{if(g)try{await (0,l.CI)(g)}catch(e){throw console.error("Logout failed",e),e}},b=e=>{if(!e)return"anonymous_org";let a=(e.email||"").split("@")[1];return a&&!["gmail.com","outlook.com","yahoo.com","hotmail.com","icloud.com"].includes(a.toLowerCase())?"org_".concat(a.replace(/[^a-z0-9]+/g,"_")):"user_".concat(e.uid.substring(0,10))},v=async e=>{if(!h)throw Error("Firestore is not initialized.");try{let a=null==g?void 0:g.currentUser,t=b(a),s=e.metadata.businessName||"Default Company",n=(0,o.H9)(h,"organizations",t);await (0,o.BN)(n,{id:t,name:s,lastUpdated:new Date().toISOString(),ownerUid:(null==a?void 0:a.uid)||null,status:"ACTIVE"},{merge:!0});let i=s.trim().toLowerCase().replace(/[^a-z0-9]+/g,"_"),r="agent_".concat(i),l=(0,o.H9)(h,"organizations/".concat(t,"/agents"),r),c={...e,integrations:{firebase:!0,googleCalendar:!1,...e.integrations||{}}};return await (0,o.BN)(l,{...c,orgId:t,savedAt:new Date().toISOString(),updatedBy:a?a.email:"anonymous",ownerUid:a?a.uid:null,status:"LOCKED"}),console.log("Configuration saved for Org: ".concat(t,", Agent: ").concat(r)),r}catch(e){throw console.error("Error saving configuration to Firebase:",e),e}},N=async()=>{if(!h||!g.currentUser)return[];let e=b(g.currentUser),a=(0,o.rJ)(h,"organizations/".concat(e,"/agents"));try{return(await (0,o.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error fetching agents:",e),[]}},w=async e=>{if(!h||!g.currentUser)return null;let a=b(g.currentUser),t=(0,o.H9)(h,"organizations/".concat(a,"/agents"),e);try{let e=await (0,o.x7)(t);if(e.exists())return e.data()}catch(e){console.error("Error fetching agent config:",e)}return null}},6822:(e,a,t)=>{Promise.resolve().then(t.bind(t,2491))}},e=>{e.O(0,[153,563,64,441,255,358],()=>e(e.s=6822)),_N_E=e.O()}]);